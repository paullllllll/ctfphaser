<html>
	<head>
		<script src="../phaser.js"></script>
	<head>
	
	<body>
		<script> 
		var game = new Phaser.Game(1000, 800, Phaser.AUTO, 'testgame', 
							{	preload: preload, 
								create: create, 
								update: update,
								render: render  });

		var player, background, bullet;
		var speed = 10;
		var hasJumped = false;
		var map, layer;
		
		function preload() {

			game.load.image('player', 'assets/sprite1.png');
			game.load.image('tileset' , 'assets/tileset.png');
			game.load.image('pew', 'assets/pew.png');
			game.load.tilemap('map', 'assets/bg.json', null, Phaser.Tilemap.TILED_JSON);

		}

		function create() {

              	game.width = 4000;
              	game.height = 2000;
                
			game.physics.startSystem(Phaser.Physics.P2JS);

			map = game.add.tilemap('map');
			map.addTilesetImage('tileset', 'tileset');		

			layer = map.createLayer('please');
	       	layer.resizeWorld();
			layer.fixedToCamera=false;

	       	map.setCollision(1);

	       	game.physics.p2.convertTilemap(map,layer);
	       	game.physics.p2.gravity.y =980;

	       	player = game.add.sprite(400, 300, 'player');
			game.physics.p2.enable(player);
	                   
	                       
			player.body.collideWorldBounds = true;
				
				
			game.camera.follow(player);
              	game.physics.p2.setBoundsToWorld(true, true, true, true, false);

              	game.input.onDown.add(fire, this);
			
		}

		function fire(pointer){

			bullet = game.add.sprite(player.x, player.y, 'pew');
			game.physics.p2.enable(bullet,null,null,.1);
			bullet.velocity.x = pointer.x-bullet.x;
			bullet.velocity.y = pointer.y-bullet.y;

		}
		
		function update() {

			if (game.input.keyboard.isDown(Phaser.Keyboard.A))
			{

				player.body.moveLeft(300);
				player.body.angle = -15;

			}
			else if (game.input.keyboard.isDown(Phaser.Keyboard.D))
			{
	
			player.body.moveRight(300);
				player.body.angle = 15;

			}
			
			else{
				
				player.body.rotation = 0;
			
			}
			
			if(game.input.keyboard.isDown(Phaser.Keyboard.W)){
			        
				player.body.moveUp(300);
                                
			}
		}


        function render(){

        }
		
		
	
		</script>
	
	</body>
	
</html>